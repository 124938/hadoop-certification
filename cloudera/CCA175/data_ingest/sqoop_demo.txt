sqoop help

/******************************************************************************
usage: sqoop COMMAND [ARGS]

Available commands:
  codegen            Generate code to interact with database records
  create-hive-table  Import a table definition into Hive
  eval               Evaluate a SQL statement and display the results
  export             Export an HDFS directory to a database table
  help               List available commands
  import             Import a table from a database to HDFS
  import-all-tables  Import tables from a database to HDFS
  import-mainframe   Import datasets from a mainframe server to HDFS
  job                Work with saved jobs
  list-databases     List available databases on a server
  list-tables        List available tables in a database
  merge              Merge results of incremental imports
  metastore          Run a standalone Sqoop metastore
  version            Display version information
******************************************************************************/

/********************************* Common useful commands - START **********************************/

#### Problem Statement - Display version

sqoop version

#### Problem Statement - List available databases on a server

sqoop list-databases \
 --connect jdbc:mysql://quickstart.cloudera:3306 \
 --username retail_dba \
 --password cloudera

#### Problem Statement - List available tables on a database

sqoop list-tables \
 --connect jdbc:mysql://quickstart.cloudera:3306/retail_db \
 --username retail_dba \
 --password cloudera

#### Problem Statement - Evaluate a SQL statement (DDL/DML) and display the results

sqoop eval \
 --connect jdbc:mysql://quickstart.cloudera:3306/retail_db \
 --username retail_dba \
 --password cloudera \
 --query "select count(1) from customers"

/********************************* Common useful commands - END **********************************/

/********************************* Import all tables - START **********************************/

sqoop import-all-tables --help

#### Problem Statement - Import all tables from database to HDFS

hadoop fs -mkdir /user/cloudera/sqoop_import_all_retail_db_text

sqoop import-all-tables \
 --connect jdbc:mysql://quickstart.cloudera:3306/retail_db \
 --username retail_dba \
 --password cloudera \
 --warehouse-dir /user/cloudera/sqoop_import_all_retail_db_text

hadoop fs -ls -R /user/cloudera/sqoop_import_all_retail_db_text
hadoop fs -cat /user/cloudera/sqoop_import_all_retail_db_text/categories/part* | wc -l
hadoop fs -cat /user/cloudera/sqoop_import_all_retail_db_text/orders/part* | wc -l

mysql -u retail_dba -p
mysql> use retail_db;
mysql> select count(1) from categories;
mysql> select count(1) from orders;

#### Problem Statement - Import all tables from database to HDFS (By changing the default delimiters)

hadoop fs -mkdir /user/cloudera/sqoop_import_all_retail_db_text_delimiter

sqoop import-all-tables \
 --connect jdbc:mysql://quickstart.cloudera:3306/retail_db \
 --username retail_dba \
 --password cloudera \
 --warehouse-dir /user/cloudera/sqoop_import_all_retail_db_text_delimiter \
 --enclosed-by "\"" \
 --fields-terminated-by "|" \
 --lines-terminated-by "\n"

hadoop fs -ls -R /user/cloudera/sqoop_import_all_retail_db_text_delimiter
hadoop fs -cat /user/cloudera/sqoop_import_all_retail_db_text_delimiter/categories/part*

#### Problem Statement - Import all tables from database to HDFS (By compressing the text file)

hadoop fs -mkdir /user/cloudera/sqoop_import_all_retail_db_text_comp

sqoop import-all-tables \
 --connect jdbc:mysql://quickstart.cloudera:3306/retail_db \
 --username retail_dba \
 --password cloudera \
 --warehouse-dir /user/cloudera/sqoop_import_all_retail_db_text_comp \
 --as-textfile \
 --compress \
 --compression-codec org.apache.hadoop.io.compress.SnappyCodec

hadoop fs -ls -R /user/cloudera/sqoop_import_all_retail_db_text_comp
hadoop fs -cat /user/cloudera/sqoop_import_all_retail_db_text_comp/categories/part*

#### Problem Statement - Import all tables from database to HDFS (By changing the file format as AVRO with file compression)

hadoop fs -mkdir /user/cloudera/sqoop_import_all_retail_db_avro_comp

sqoop import-all-tables \
 --connect jdbc:mysql://quickstart.cloudera:3306/retail_db \
 --username retail_dba \
 --password cloudera \
 --warehouse-dir /user/cloudera/sqoop_import_all_retail_db_avro_comp \
 --as-avrodatafile \
 --compress \
 --compression-codec org.apache.hadoop.io.compress.SnappyCodec

hadoop fs -ls -R /user/cloudera/sqoop_import_all_retail_db_avro_comp

avro-tools tojson hdfs://quickstart.cloudera/user/cloudera/sqoop_import_all_retail_db_avro_comp/categories/part-m-00000.avro
avro-tools tojson hdfs://quickstart.cloudera/user/cloudera/sqoop_import_all_retail_db_avro_comp/customers/part-m-00000.avro

#### Problem Statement - Import all tables from database to HDFS (By changing the file format as Sequence file)

hadoop fs -mkdir /user/cloudera/sqoop_import_all_retail_db_seq

sqoop import-all-tables \
 --connect jdbc:mysql://quickstart.cloudera:3306/retail_db \
 --username retail_dba \
 --password cloudera \
 --warehouse-dir /user/cloudera/sqoop_import_all_retail_db_seq \
 --as-sequencefile 

hadoop fs -ls -R /user/cloudera/sqoop_import_all_retail_db_seq

#### Problem Statement - Import all tables from database to HDFS (By changing the file format as Parquet file)

hadoop fs -mkdir /user/cloudera/sqoop_import_all_retail_db_parquet

sqoop import-all-tables \
 --connect jdbc:mysql://quickstart.cloudera:3306/retail_db \
 --username retail_dba \
 --password cloudera \
 --warehouse-dir /user/cloudera/sqoop_import_all_retail_db_parquet \
 --as-parquetfile 

hadoop fs -ls -R /user/cloudera/sqoop_import_all_retail_db_parquet

parquet-tools --help
parquet-tools cat --json hdfs://quickstart.cloudera/user/cloudera/sqoop_import_all_retail_db_parquet/products/a09a312d-7bd2-4049-a5eb-8f3a41c3daa1.parquet
parquet-tools head --records 10 hdfs://quickstart.cloudera/user/cloudera/sqoop_import_all_retail_db_parquet/products/a09a312d-7bd2-4049-a5eb-8f3a41c3daa1.parquet
parquet-tools schema --detailed hdfs://quickstart.cloudera/user/cloudera/sqoop_import_all_retail_db_parquet/products/a09a312d-7bd2-4049-a5eb-8f3a41c3daa1.parquet

/********************************* Import all tables - END **********************************/
